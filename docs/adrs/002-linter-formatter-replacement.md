# ADR 002: Linter/Formatterの選定とESLintからの移行

## ステータス

承認済み（2026-01-27）

## コンテキスト

プロジェクトのコード品質とフォーマット統一のため、適切なlinter/formatterツールの選定が必要です。現在はESLint 9を使用していますが、formatterは導入されていません。

### 要件

- 高速なlint/format処理
- TypeScript、React、Next.jsのサポート
- 設定の簡潔性とメンテナンス性
- CI/CDでの実行効率
- 開発者体験の向上

### 現状の課題

- Formatterが未導入でコードスタイルの統一が不十分
- ESLintの実行速度がプロジェクト規模の拡大に伴い課題となる可能性
- 複数ツールの設定管理が煩雑になる懸念

## 検討した選択肢

### 1. Biome

#### 概要
Rome Toolsの後継プロジェクト。Rust製でlinterとformatterを統合したツールチェーン。

#### 主な機能
- 統合されたlinter + formatter
- 高速処理（Rustベース）
- 単一の設定ファイル（`biome.json`）
- Next.js、React、TypeScriptの完全サポート
- ESLintからの移行ツール提供

#### 長所
- ✅ linter/formatterが統合され設定が簡潔
- ✅ 十分に高速
- ✅ 成熟度が高く本番環境で広く採用
- ✅ Next.jsとの相性が良い
- ✅ ESLintからの移行が比較的容易

#### 短所
- ❌ ESLintのエコシステム（プラグイン）が使えない
- ❌ カスタムルールの追加が限定的

#### 評価
⭐⭐⭐⭐⭐（最も推奨）

---

### 2. oxlint + oxfmt

#### 概要
Oxcプロジェクトが提供するRust製のlinterとformatter。ESLintの10-100倍の速度を謳う。

#### 主な機能
- 超高速なlint処理
- TypeScript、JSX/TSXサポート
- ESLint互換のルールセット
- oxfmtはPrettier互換を目指した設計

#### 長所
- ✅ 最速のlinter性能
- ✅ 最先端の技術スタック
- ✅ ESLintルールとの互換性

#### 短所
- ❌ oxfmtは開発初期段階（2026年1月時点）
- ❌ ドキュメントが限定的
- ❌ エッジケースでの動作に不確実性
- ❌ コミュニティが小さい

#### 評価
⭐⭐⭐（実験的プロジェクト向け）

---

### 3. oxlint + Prettier

#### 概要
最速のlinterと成熟したformatterの組み合わせ。

#### 主な機能
- oxlintの超高速lint
- Prettierの安定したformat
- 既存エコシステムとの互換性

#### 長所
- ✅ 最速のlint処理
- ✅ Prettierの安定性と豊富なプラグイン
- ✅ トラブルシューティングが容易

#### 短所
- ❌ 2つのツールを管理する必要
- ❌ oxlintがまだ比較的新しい

#### 評価
⭐⭐⭐⭐（速度と安定性のバランス重視）

---

### 4. ESLint + Prettier

#### 概要
最も成熟した標準的な組み合わせ。

#### 主な機能
- 豊富なESLintプラグイン
- Prettierの安定性
- 広範なコミュニティサポート

#### 長所
- ✅ 最も成熟したエコシステム
- ✅ プラグインが豊富
- ✅ トラブルシューティングが最も容易

#### 短所
- ❌ 他の選択肢と比べて処理速度が遅い
- ❌ 2つのツールの設定管理が必要

#### 評価
⭐⭐⭐⭐（安定性最優先の場合）

---

## 決定

**oxlint + oxfmt** を採用します。

### 決定理由

1. **速度最優先**: プロジェクトの成長に伴う処理時間の増加を最小化
2. **最新技術への挑戦**: 個人ブログプロジェクトという特性上、実験的技術の採用が可能
3. **学習機会**: Oxcエコシステムの理解を深める
4. **将来性**: Oxcプロジェクトは活発に開発されており、今後の成熟が期待できる

### リスク認識

- oxfmtの開発段階が初期であることを理解した上での採用
- エッジケースでの問題発生時は、Biomeや他のツールへの切り替えを検討
- 本番環境での使用には慎重な検証が必要

### フォールバックプラン

問題が発生した場合の移行先候補：
1. **第一候補**: Biome（統合ツールチェーン、高い成熟度）
2. **第二候補**: oxlint + Prettier（安定したformatter）

## 影響

### ポジティブな影響

- Lint/format処理の大幅な高速化
- CI/CD実行時間の短縮
- 最新技術スタックへの知見獲得

### ネガティブな影響（想定）

- 初期セットアップでのトラブルシューティングが必要となる可能性
- ドキュメントの不足による学習コスト
- エッジケースでの予期しない動作

### マイグレーション計画

1. ESLint関連パッケージの削除
2. oxlint、oxc-formatterのインストール
3. `.oxlintrc.json`の作成
4. `.oxfmtrc.json`の作成
5. `package.json`スクリプトの更新
6. `eslint.config.mjs`の削除
7. 全ファイルでのlint/format実行とエラー修正
8. CI/CDの設定更新（必要に応じて）

## 参考資料

- [Oxc Project](https://oxc.rs/)
- [oxlint Documentation](https://oxc.rs/docs/guide/usage/linter.html)
- [Biome](https://biomejs.dev/)
- [ESLint](https://eslint.org/)